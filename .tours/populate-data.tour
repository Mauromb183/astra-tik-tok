{
  "$schema": "https://aka.ms/codetour-schema",
  "title": "5. Populate Data",
  "nextTour": "6. Hook Everything Together",
  "steps": [
    {
      "title": "Import data from data.json",
      "file": "astra-tik-tok/functions/addData.js",
      "selection": {
        "start": {
          "line": 1,
          "character": 1
        },
        "end": {
          "line": 31,
          "character": 5
        }
      },
      "description": "## Update addData.js\n\nUpdate the addData.js file so it pulls from data.json using fs() instead of having hard coded values.\n\n```jsx\nconst fs = import('fs')\nconst { createClient } = require(\"@astrajs/collections\")\n\nconst collection = 'posts'\n\nexports.handler = async function (event, context, callback) {\n    const fs = require('fs')\n      const astraClient = await createClient({\n       astraDatabaseId: process.env.ASTRA_DB_ID,\n       astraDatabaseRegion: process.env.ASTRA_DB_REGION,\n       applicationToken: process.env.ASTRA_DB_APPLICATION_TOKEN,\n     });\n\n  const posts = astraClient\n    .namespace(process.env.ASTRA_DB_KEYSPACE)\n    .collection(collection)\n\n  const data = JSON.parse(fs.readFileSync('/config/workspace/resources/data.json'))\n    \n  try {\n        for (let i = 0; i < data.length; i++) {\n          await posts.create(data[i].id.toString(), data[i])\n        }\n\n        return {\n            statusCode: 200,\n        }\n    } catch (e) {\n        console.error(e);\n        return {\n            statusCode: 500,\n            body: JSON.stringify(e),\n        }\n    }\n}  \n```",
      "line": 136
    },
    {
      "file": "astra-tik-tok/functions/addData.js",
      "selection": {
        "start": {
          "line": 16,
          "character": 5
        },
        "end": {
          "line": 30,
          "character": 6
        }
      },
      "description": "```jsx\nconst data = [\n    {\n      \"id\":0,\n      \"name\":\"Mo Farooq\",\n      \"username\":\"mofarooq32\",\n      \"avatar\":\"https://i.imgur.com/9KYq7VG.png\",\n      \"is_followed\":true,\n      \"video\":\"https://i.imgur.com/FTBP02Y.mp4\",\n      \"caption\":\"These ducks are MEGA cute\",\n      \"likes\":10,\n      \"comments\":2,\n      \"timestamp\":\"2019-03-10T09:08:31.020Z\",\n      \"button_visible\":true\n    },\n    {\n      \"id\":1,\n      \"name\":\"Tim Salowski\",\n      \"username\":\"timmytam\",\n      \"avatar\":\"https://i.imgur.com/rWYtZa6.png\",\n      \"is_followed\":false,\n      \"video\":\"https://i.imgur.com/1A7AKoF.mp4\",\n      \"caption\":\"When your fries give you attitude #getInMyBelly\",\n      \"likes\":12,\n      \"comments\":2,\n      \"timestamp\":\"2020-03-10T09:08:31.020Z\",\n      \"button_visible\":true\n    },\n    {\n      \"id\":2,\n      \"name\":\"Angela Lee\",\n      \"username\":\"angiecakes\",\n      \"avatar\":\"https://i.imgur.com/eX3hkoc.png\",\n      \"is_followed\":true,\n      \"video\":\"https://i.imgur.com/al6MLay.mp4\",\n      \"caption\":\"Happiest of Birthdays my Angel\",\n      \"likes\":2,\n      \"comments\":4,\n      \"timestamp\":\"2020-04-10T09:08:31.020Z\",\n      \"button_visible\":true\n    },\n    {\n      \"id\":3,\n      \"name\":\"Nina Xen\",\n      \"username\":\"nina_lina\",\n      \"avatar\":\"https://i.imgur.com/IigY4Hm.png\",\n      \"is_followed\":false,\n      \"video\":\"https://i.imgur.com/Kzvbeup.mp4\",\n      \"caption\":\"The new normal\",\n      \"likes\":10,\n      \"comments\":2,\n      \"timestamp\":\"2020-05-10T09:08:31.020Z\",\n      \"button_visible\":true\n    },\n    {\n      \"id\":0,\n      \"name\":\"Lana Del Mont\",\n      \"username\":\"lana_del_away\",\n      \"avatar\":\"https://i.imgur.com/jONHmE5.png\",\n      \"is_followed\":true,\n      \"video\":\"https://i.imgur.com/H9UX0Jm.mp4\",\n      \"caption\":\"Art is for everyone\",\n      \"likes\":231,\n      \"comments\":20,\n      \"timestamp\":\"2020-09-10T09:08:31.020Z\",\n      \"button_visible\":true\n    }\n  ]\n\ntry {\n    for (let i = 0; i < data.length; i++) {\n        await posts.create(data[i].id.toString(), data[i])\n        }\n        return {\n            statusCode: 200,\n        }\n        } catch (e) {\n            console.error(e);\n            return {\n                statusCode: 500,\n                body: JSON.stringify(e),\n                }\n            }\n```",
      "line": 15
    },
    {
      "title": "Import the data and check the results",
      "description": "## Import the Data\n\nCommit your changes.\n\n>> git add -A\n\n>> git commit -a -m \"Adding more data\"\n\n>> git push origin main\n\nFirst, visit the [addData](https://adoring-golick-98d83c.netlify.app/.netlify/functions/addData) endpoint to upload the data.\n\nThen, check [post](https://adoring-golick-98d83c.netlify.app/.netlify/functions/post) to make sure the new information is there."
    }
  ]
}